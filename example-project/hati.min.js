export default function hati(a){function b(a){c(a.target),history.pushState({},null,a.target.href),d(a)}function c(a){const b=new CustomEvent("hati:beforeLoad",{bubbles:!0,cancelable:!0,detail:{href:a.href}});a.dispatchEvent(b)}async function d(a){a.preventDefault();const b=e(a.target);!b?j(a.target):f(a.target,b)}function e(b){const c=b.getAttribute("data-target-id"),d=a.root.querySelector(`#${c}`);return d}async function f(b,c){const d=a?.router?a.router(b.href):b.href,e=await g(d);h(c,e.content),hati({...a,root:c}),i(c,{href:b.href,responseStatusCode:e.statusCode})}async function g(a){let b=await fetch(a);const c=await b.text();return{content:c,statusCode:b.status}}function h(a,b){for(;a.lastChild;)a.removeChild(a.lastChild);a.insertAdjacentHTML("afterbegin",b)}function i(a,b){const c=new CustomEvent("hati:DOMContentLoaded",{bubbles:!0,cancelable:!0,detail:b});a.dispatchEvent(c)}function j(a){const b=`No element found with id: ${a.getAttribute("data-target-id")}`,c=new CustomEvent("hati:error",{bubbles:!0,cancelable:!0,detail:{href:a.href,errorMessage:b}});a.dispatchEvent(c),console.error(b)}const k=a.root.querySelectorAll("a[data-target-id]:not([data-target-id=\"\"])");k.forEach(c=>c.addEventListener("click",b))}
