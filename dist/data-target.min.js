"use strict";(()=>{function d(t){t.querySelectorAll('a[data-target]:not([data-target=""])').forEach(e=>e.addEventListener("click",t=>{t.preventDefault(),r(e,{id:e.getAttribute("data-target")})})),t.querySelectorAll('form[data-target]:not([data-target=""])').forEach(e=>e.addEventListener("submit",t=>{t.preventDefault(),r(e,{id:e.getAttribute("data-target")})}))}async function r(e,t,n){var r;try{"string"==typeof e&&(e=new URL(e));const c=function(t){var e=document.getElementById(t.id);if(null!==e)return e;throw new Error(`data-target: No target element found with ID "${t.id}"`)}(t);var a=f(e),o=(c.dispatchEvent(new CustomEvent("data-target:before-load",{bubbles:!0,detail:{url:a.href}})),await function(t,e){var n=f(t);if(t instanceof HTMLAnchorElement)return window.dataTarget.config.httpRequestDispatcher(n,e);if(t instanceof HTMLFormElement){const r=t.method;e=new FormData(t);return"get"===r.toLowerCase()?function(t,e){const n=Array.from(e.entries()),r=n.map(([t,e])=>e instanceof File?null:[t,e]).filter(t=>!!t),a=new URLSearchParams(Object.fromEntries(r));return window.dataTarget.config.httpRequestDispatcher(t.action+"?"+a)}(t,e):window.dataTarget.config.httpRequestDispatcher(n,{method:r,body:e})}return window.dataTarget.config.httpRequestDispatcher(n)}(e,n));if(null==(r=null==n?void 0:n.signal)||!r.aborted){for(var i=c,s={html:o.content};i.lastChild;)i.removeChild(i.lastChild);i.insertAdjacentHTML("afterbegin",s.html),d(c),c.dispatchEvent(new CustomEvent("data-target:loaded",{bubbles:!0,detail:{url:a.href,responseStatusCode:o.statusCode}}))}}catch(t){window.dataTarget.config.errorHandler(t,e)}}function f(t){return t instanceof HTMLAnchorElement?new URL(t.href):t instanceof HTMLFormElement?new URL(t.action):t}window.dataTarget={config:{errorHandler:function(t,e){console.error({error:t,urlOrInvokerElement:e})},httpRequestDispatcher:async function(t,e){const n=await fetch(t,e);return{content:await n.text(),statusCode:n.status}}},$:{request:async function(e,t,n){try{if(!("string"==typeof e||e instanceof URL||e instanceof HTMLAnchorElement||e instanceof HTMLFormElement))throw new Error("The first parameter of the request function must be of one of the following types: string, URL, HTMLAnchorElement, HTMLFormElement");if("string"==typeof e||e instanceof URL){if(t)return r(e,{id:t},n);throw new Error("When passing a URL object or a string in the first parameter of the request function, a second parameter containing the target element id is mandatory, but it was not provided")}if(e.hasAttribute("data-target"))return e instanceof HTMLAnchorElement?r(e,{id:e.href},n):r(e,{id:e.action},n);if(t)return r(e,{id:t},n);throw new Error("When an element without the data-target property is passed in the first parameter of the request function, a second parameter containing the target element id is mandatory, but it was not provided")}catch(t){window.dataTarget.config.errorHandler(t,e)}},attach:d}},Object.freeze(window.dataTarget.$),d(document.body)})();