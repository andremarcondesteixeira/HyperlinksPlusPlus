"use strict";(()=>{function s(t){t.querySelectorAll('a[data-target]:not([data-target=""])').forEach(e=>e.addEventListener("click",t=>{t.preventDefault(),r(e,{id:e.getAttribute("data-target")})})),t.querySelectorAll('form[data-target]:not([data-target=""])').forEach(e=>e.addEventListener("submit",t=>{t.preventDefault(),r(e,{id:e.getAttribute("data-target")})}))}async function r(e,t){try{"string"==typeof e&&(e=new URL(e));{var r=e;var n=t;const a=function(t){var e=document.getElementById(t.id);if(null!==e)return e;throw new Error(`data-target: No target element found with ID "${t.id}"`)}(n),o=d(r),i=(a.dispatchEvent(new CustomEvent("data-target:before-load",{bubbles:!0,detail:{url:o.href}})),await function(t){var e=d(t);if(t instanceof HTMLAnchorElement||!(t instanceof HTMLFormElement))return window.dataTarget.config.httpRequestDispatcher(e);{const n=t.method;var r=new FormData(t);return"get"===n.toLowerCase()?function(t,e){const r=Array.from(e.entries()),n=r.map(([t,e])=>e instanceof File?null:[t,e]).filter(t=>!!t),a=new URLSearchParams(Object.fromEntries(n));return window.dataTarget.config.httpRequestDispatcher(t.action+"?"+a)}(t,r):window.dataTarget.config.httpRequestDispatcher(e,{method:n,body:r})}}(r));(function(t,e){for(;t.lastChild;)t.removeChild(t.lastChild);t.insertAdjacentHTML("afterbegin",e.html)})(a,{html:i.content}),s(a),a.dispatchEvent(new CustomEvent("data-target:loaded",{bubbles:!0,detail:{url:o.href,responseStatusCode:i.statusCode}}));return void await void 0}}catch(t){window.dataTarget.config.errorHandler(t,e)}}function d(t){return t instanceof HTMLAnchorElement?new URL(t.href):t instanceof HTMLFormElement?new URL(t.action):t}window.dataTarget={config:{errorHandler:(t,e)=>console.error({error:t,urlOrInvokerElement:e}),httpRequestDispatcher:async(t,e)=>{const r=await fetch(t,e);return{content:await r.text(),statusCode:r.status}}},$:{request:async(e,t)=>{try{if(!("string"==typeof e||e instanceof URL||e instanceof HTMLAnchorElement||e instanceof HTMLFormElement))throw new Error("The first parameter of the request function must be of one of the following types: string, URL, HTMLAnchorElement, HTMLFormElement");if("string"==typeof e||e instanceof URL){if(t)return r(e,{id:t});throw new Error("When passing a URL object or a string in the first parameter of the request function, a second parameter containing the target element id is mandatory, but it was not provided")}if(e.hasAttribute("data-target"))return e instanceof HTMLAnchorElement?r(e,{id:e.href}):r(e,{id:e.action});if(t)return r(e,{id:t});throw new Error("When an element without the data-target property is passed in the first parameter of the request function, a second parameter containing the target element id is mandatory, but it was not provided")}catch(t){window.dataTarget.config.errorHandler(t,e)}},attach:t=>s(t)}},Object.freeze(window.dataTarget.$),s(document.body)})();