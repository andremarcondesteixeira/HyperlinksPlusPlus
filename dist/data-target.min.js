"use strict";(()=>{function d(t){t.querySelectorAll('a[data-target]:not([data-target=""])').forEach(e=>e.addEventListener("click",t=>{t.preventDefault(),n(e,{id:e.getAttribute("data-target")})})),t.querySelectorAll('form[data-target]:not([data-target=""])').forEach(e=>e.addEventListener("submit",t=>{t.preventDefault(),n(e,{id:e.getAttribute("data-target")})}))}async function n(e,t){try{"string"==typeof e&&(e=new URL(e));{var n=e;var r=t;const a=function(t){var e=document.getElementById(t.id);if(null!==e)return e;throw new Error(`data-target: No target element found with ID "${t.id}"`)}(r),o=window.dataTarget.config.loadingIndicator(),i=o instanceof HTMLElement?o.outerHTML:o,{response:s,url:c}=(f(a,{html:i}),await async function(t){let e,n;if(t instanceof HTMLAnchorElement)e=new URL(t.href),n=await window.dataTarget.config.httpRequestDispatcher(e);else if(t instanceof HTMLFormElement){e=new URL(t.action);const a=t.method;var r=new FormData(t);n="get"===a.toLowerCase()?await function(t,e){const n=Array.from(e.entries()),r=n.map(([t,e])=>e instanceof File?null:[t,e]).filter(t=>!!t),a=new URLSearchParams(Object.fromEntries(r));return window.dataTarget.config.httpRequestDispatcher(t.action+"?"+a)}(t,r):await window.dataTarget.config.httpRequestDispatcher(e,{method:a,body:r})}else e=new URL(t.href),n=await window.dataTarget.config.httpRequestDispatcher(e);return{url:e,response:n}}(n));f(a,{html:s.content}),d(a),a.dispatchEvent(new CustomEvent("data-target:load",{bubbles:!0,cancelable:!0,detail:{url:c.href,targetElementId:r.id,responseStatusCode:s.statusCode}}));return void await void 0}}catch(t){window.dataTarget.config.errorHandler(t,e)}}function f(t,e){for(;t.lastChild;)t.removeChild(t.lastChild);t.insertAdjacentHTML("afterbegin",e.html)}window.dataTarget={config:{errorHandler:(t,e)=>console.error({error:t,urlOrInvokerElement:e}),httpRequestDispatcher:async(t,e)=>{const n=await fetch(t,e);return{content:await n.text(),statusCode:n.status}},loadingIndicator:()=>{const t=document.createElement("span");return t.innerText="loading",t}},request:async(e,t)=>{try{if(!("string"==typeof e||e instanceof URL||e instanceof HTMLAnchorElement||e instanceof HTMLFormElement))throw new Error("The first parameter of the request function must be of one of the following types: string, URL, HTMLAnchorElement, HTMLFormElement");if("string"==typeof e||e instanceof URL){if(t)return n(e,{id:t});throw new Error("When passing a URL object or a string in the first parameter of the request function, a second parameter containing the target element id is mandatory, but it was not provided")}if(e.hasAttribute("data-target"))return e instanceof HTMLAnchorElement?n(e,{id:e.href}):n(e,{id:e.action});if(t)return n(e,{id:t});throw new Error("When an element without the data-target property is passed in the first parameter of the request function, a second parameter containing the target element id is mandatory, but it was not provided")}catch(t){window.dataTarget.config.errorHandler(t,e)}},attach:t=>d(t)},d(document.body)})();