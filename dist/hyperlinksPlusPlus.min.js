window.addEventListener("popstate",t=>tryLoadContent(location.href,t.state.targetId)),initialize(document.body);const config={urlTransformer:t=>t,errorHandler:t=>console.error(t),httpRequestDispatcher:async t=>{const e=await fetch(t);return{content:await e.text(),statusCode:e.status}}};export default config;function initialize(t){addClickListeners(t);let e=t.querySelectorAll('a[data-autoload][data-target]:not([data-target=""])');e.forEach(t=>t.click())}function addClickListeners(t){const e=t.querySelectorAll('a[data-target]:not([data-target=""])');e.forEach(t=>{t.addEventListener("click",handleClick)});const a=t.querySelectorAll('[data-default-target]:not([data-default-target=""])');a.forEach(e=>{const t=e.querySelectorAll("a:not([data-target])");t.forEach(t=>{t.setAttribute("data-target",e.getAttribute("data-default-target")),t.addEventListener("click",handleClick)})})}function handleClick(t){t.preventDefault();const e=t.target;t=e.getAttribute("data-target");history.pushState({targetId:t},"",e.href),tryLoadContent(e.href,t)}function tryLoadContent(t,e){try{loadContent(t,getTargetElement(t,e))}catch(t){config.errorHandler(t)}}function getTargetElement(t,e){var a=document.querySelector(`#${e}`);if(!a)throw new Error(`No element found with id "${e}" to render response from ${t}`);return a}async function loadContent(t,e){var a=await config.httpRequestDispatcher(config.urlTransformer(t));renderContentInsideTargetElement(e,a.content),initialize(e),dispatchContentLoadedEvent(e,{url:t,responseStatusCode:a.statusCode})}function renderContentInsideTargetElement(t,e){for(;t.lastChild;)t.removeChild(t.lastChild);t.insertAdjacentHTML("afterbegin",e)}function dispatchContentLoadedEvent(t,a){t.dispatchEvent(new CustomEvent("content-loaded",{bubbles:!0,cancelable:!0,detail:{...a,matchUrl:(t,e)=>{t.test(a.url)&&e()}}}))}